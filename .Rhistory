install.packages("salso")
library(salso)
source("code/include_all.R")
knitr::opts_chunk$set(echo = TRUE)
pollutant <- read.csv('code/data/pollutant.csv')
stationInfo <- read.csv('code/data/stationsInfo.csv')
##get latitude and longitude
latitude <- c()
longitude <- c()
region <- c()
for (i in 1:dim(pollutant)[2]) {
site <- colnames(pollutant)[i]
latitude <- c(latitude,stationInfo$latitude[which(stationInfo$site==site)])
longitude <- c(longitude,stationInfo$longitude[which(stationInfo$site==site)])
region <- c(region,stationInfo$region[which(stationInfo$site==site)])
}
load("code/results/result_proposedmodel.RData")
gnstar <- as.numeric(salso(tseriesc.out$memorygn, maxNClusters=4,
loss=VI(a=0.5), nRuns=50, nCores=2))
#compute mean rho
d <- dim(tseriesc.out$rhosample)[1]
rho <- tseriesc.out$rhosample[d,]
rho_m <- c()
for (i in 1:4) {
rho_m <- c(rho_m, round(mean(rho[which(gnstar==i)]),2) )
}
plot(longitude,latitude,pch=19,cex=2,main = "Proposed model", xlab="", ylab="",col=gnstar)
legend('topleft',legend=rho_m,col=1:4,pch=19)
map("world",add=T)
x <- 30:300                      #x is defined just for visual purposes
x <- x[which(x %% 2 == 0)]
x <- x[-1]
par(mfrow=c(2,1))
station <- 112
rhosample <- tseriesc.out$rhosample[,station]
plot(x,cumsum(rhosample)/1:d,type = "l",main = "Ergodic mean of rho ",xlab = "Iteration number",ylab = "",ylim=c(0.55,0.85))
acf(rhosample, main='Autocorrelation of rho')
gnstar[112]     #4th cluster, "blue" one
par(mfrow=c(2,1))
station <- 102
rhosample <- tseriesc.out$rhosample[,station]
plot(x,cumsum(rhosample)/1:n,type = "l",main = "Ergodic mean of rho",xlab = "Iteration number",ylab = "",ylim=c(0.55,0.85))
x <- 30:300                      #x is defined just for visual purposes
x <- x[which(x %% 2 == 0)]
x <- x[-1]
par(mfrow=c(2,1))
station <- 112
rhosample <- tseriesc.out$rhosample[,station]
plot(x,cumsum(rhosample)/1:d,type = "l",main = "Ergodic mean of rho ",xlab = "Iteration number",ylab = "",ylim=c(0.55,0.85))
acf(rhosample, main='Autocorrelation of rho')
gnstar[112]     #4th cluster, "blue" one
par(mfrow=c(2,1))
station <- 102
rhosample <- tseriesc.out$rhosample[,station]
plot(x,cumsum(rhosample)/1:d,type = "l",main = "Ergodic mean of rho",xlab = "Iteration number",ylab = "",ylim=c(0.55,0.85))
acf(rhosample, main='Autocorrelation of rho')
gnstar[102]     #2nd cluster, "red" one
